{% extends "base.html" %}
{% load static %}

{% block content %}
  <h1>Panel de due√±o de cafeter√≠as</h1>

  <p><a href="{% url 'create_cafe' %}" class="btn-add-cafe">‚ûï Agregar nueva cafeter√≠a</a></p>
  <p><a href="{% url 'owner_reviews' %}" class="btn-view-reviews">üìã Ver todas las rese√±as</a></p>

  {% if cafes %}
    <ul class="cafe-list">
      {% for cafe in cafes %}
        <li class="cafe-item">
          <div class="cafe-info">
            <strong>{{ cafe.name }}</strong> ({{ cafe.location }})<br>
            üìç {{ cafe.address }}<br>

            {% if cafe.photo1 %}
              <img src="{{ cafe.photo1.url }}" alt="Foto de {{ cafe.name }}" class="miniatura-cafe">
            {% endif %}

            {% if cafe.average_rating %}
              ‚òï {{ cafe.average_rating|floatformat:1 }}
            {% else %}
              ‚òï Sin puntuar
            {% endif %}<br>

            üßæ Rese√±as: {{ cafe.total_reviews }}<br>

            <div class="cafe-actions">
              <a href="{% url 'cafe_detail' cafe.id %}" class="action-link">üîç Ver detalles</a>
              <a href="{% url 'edit_cafe' cafe.id %}" class="action-link">‚úèÔ∏è Editar</a>
              <form action="{% url 'delete_cafe' cafe.id %}" method="post" class="delete-form">
                {% csrf_token %}
                <button type="submit" onclick="return confirm('¬øEst√°s seguro de eliminar esta cafeter√≠a?')" class="delete-button">üóëÔ∏è Eliminar</button>
              </form>
            </div>
          </div>
        </li>
      {% endfor %}
    </ul>
  {% else %}
    <p>No ten√©s cafeter√≠as registradas todav√≠a.</p>
  {% endif %}

  <style>
    .btn-add-cafe {
      padding: 8px 16px;
      background-color: #4CAF50;
      color: white;
      text-decoration: none;
      border-radius: 5px;
      display: inline-block;
      margin-bottom: 1rem;
    }

    .btn-view-reviews {
      background-color: #007bff;
      color: white;
      padding: 8px 16px;
      text-decoration: none;
      border-radius: 5px;
      font-weight: bold;
    }

    .btn-view-reviews:hover {
      background-color: #0056b3;
    }

    .cafe-list {
      padding: 0;
      list-style: none;
    }

    .cafe-item {
      border: 1px solid #ccc;
      border-radius: 8px;
      padding: 12px;
      margin-bottom: 1rem;
      background-color: #f9f9f9;
    }

    .miniatura-cafe {
      width: 120px;
      height: auto;
      border-radius: 6px;
      margin: 6px 0;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
    }

    .cafe-actions {
      margin-top: 0.5rem;
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    .action-link {
      color: #007bff;
      text-decoration: none;
      font-weight: bold;
    }

    .action-link:hover {
      text-decoration: underline;
    }

    .delete-form {
      display: inline;
    }

    .delete-button {
      background: none;
      border: none;
      color: red;
      cursor: pointer;
      font-weight: bold;
    }

    @media (max-width: 600px) {
      .cafe-item {
        font-size: 0.95em;
      }

      .miniatura-cafe {
        width: 100%;
        max-width: 100%;
        height: auto;
      }

      .cafe-actions {
        flex-direction: column;
        gap: 5px;
      }
    }
  </style>

{% endblock %}
