<!DOCTYPE html>
<html lang="es">
{% load static %}
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  {# === NUEVO: t√≠tulo y description din√°micos === #}
  {% block head_title %}
    <title>{{ meta_title|default:"Gota - Rese√±as de Caf√©s" }}</title>
  {% endblock %}
  {% block head_description %}
    <meta name="description" content="{{ meta_description|default:'Descubr√≠ cafeter√≠as, rese√±as reales y mapas.' }}">
  {% endblock %}

  {# Meta extra por p√°gina (OG/Twitter, canonical, JSON-LD, etc.) #}
  {% block meta %}{% endblock %}

  <!-- Animaciones -->
  <link rel="stylesheet" href="{% static 'css/animations.css' %}">

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { sans: ['Poppins', 'sans-serif'] },
          colors: {
            primary: '#1e3a8a', accent: '#2dd4bf', accentHover: '#14b8a6',
            secondary: '#172c6d', dark: '#111827', light: '#f9fafb'
          }
        }
      }
    }
  </script>

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet" />

  <!-- Custom CSS -->
  <link href="{% static 'css/custom.css' %}" rel="stylesheet" />

  <!-- Font Awesome (CSS) -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" crossorigin="anonymous" />

  <!-- Swiper & Leaflet CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />

  <link rel="icon" type="image/svg+xml" href="{% static 'favicon.svg' %}">

  <style>html, body { overflow-x: hidden; }</style>
</head>


<body class="bg-light text-dark font-sans">
  <div class="min-h-screen flex flex-col">

    <!-- Navbar -->
    <header class="bg-white shadow fixed w-full z-50">
      <div class="max-w-7xl mx-auto px-4 py-3 flex items-center justify-between">
        <!-- Contenedor logo + enlaces -->
        <div class="flex items-center gap-8">
          <a href="{% url 'home' %}" class="text-2xl font-bold text-primary">Gota</a>

          <!-- Toggle para mobile -->
          <button id="menu-toggle" class="lg:hidden text-gray-700">
            <i class="fas fa-bars text-xl"></i>
          </button>

          <nav id="navbar-menu" class="hidden lg:flex lg:items-center lg:gap-6">
            <a href="{% url 'home' %}" class="block py-2 lg:py-0 text-gray-700 hover:text-primary">Inicio</a>
            <a href="{% url 'cafe_list' %}" class="block py-2 lg:py-0 text-gray-700 hover:text-primary">Caf√©s</a>
            <a href="{% url 'mapa_cafes' %}" class="block py-2 lg:py-0 text-gray-700 hover:text-primary">üìç Mapa</a>
            <a href="{% url 'about' %}" class="block py-2 lg:py-0 text-gray-700 hover:text-primary">Acerca de</a>
            <a href="{% url 'contact' %}" class="block py-2 lg:py-0 text-gray-700 hover:text-primary">Contacto</a>
          </nav>
        </div>

        <!-- Botones de usuario -->
        <div class="flex items-center gap-3">
          {% if user.is_authenticated %}
            <span class="font-semibold text-gray-800">Hola, {{ user.username }}</span>
            {% if user.avatar %}
              <img src="{{ user.avatar.url }}" alt="Avatar de {{ user.username }}" class="w-8 h-8 rounded-full border object-cover" />
            {% endif %}

            {% if user.is_owner %}
              <a href="{% url 'create_cafe' %}" class="hover:underline">‚ûï Agregar Caf√©</a>
              <a href="{% url 'owner_dashboard' %}" class="hover:underline">Mis Caf√©s</a>
            {% else %}
              <a href="{% url 'register_owner' %}"
                 class="bg-green-500 hover:bg-green-600 text-white px-3 py-1.5 rounded-md font-medium transition flex items-center gap-2">
                <i class="fas fa-coffee text-sm"></i> Registrar tu caf√©
              </a>
            {% endif %}

            <a href="{% url 'account_logout' %}" class="text-red-500 hover:underline text-sm">Cerrar sesi√≥n</a>
          {% else %}
            <a href="{% url 'account_login' %}" class="text-primary hover:underline">Iniciar sesi√≥n</a>
            <a href="{% url 'account_signup' %}"
               class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-1.5 rounded-md font-medium transition">
              Registrarse
            </a>
            <a href="{% url 'register_owner' %}"
               class="bg-green-500 hover:bg-green-600 text-white px-3 py-1.5 rounded-md font-medium transition flex items-center gap-2">
              <i class="fas fa-coffee text-sm"></i> Registrar tu caf√©
            </a>
          {% endif %}
        </div>
      </div>
    </header>

    <!-- JS toggle navbar -->
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const toggle = document.getElementById("menu-toggle");
        const menu = document.getElementById("navbar-menu");
        if (toggle && menu) toggle.addEventListener("click", () => menu.classList.toggle("hidden"));
      });
    </script>

    <!-- Contenido principal -->
    <main class="flex-1 container mx-auto px-4 py-6 pt-24">
      {% if messages %}
        <div class="fixed top-4 right-4 z-50 space-y-2">
          {% for message in messages %}
            <div class="px-4 py-2 rounded shadow text-white alert-message
                        {% if message.tags == 'success' %} bg-green-500
                        {% elif message.tags == 'error' %} bg-red-500
                        {% else %} bg-blue-500 {% endif %}">
              {{ message }}
            </div>
          {% endfor %}
        </div>
      {% endif %}

      {% block content %}{% endblock %}
    </main>

    <!-- Footer -->
    <footer class="bg-white border-t py-4 text-center text-sm text-gray-500">
      ¬© 2025 Gota ‚Äì Una app de Roma ‚òï
    </footer>
  </div>

  <!-- JS externos (defer) -->
  <script defer src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
  <script defer src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script defer src="{% static 'js/main.js' %}"></script>

  <!-- L√≥gica com√∫n (alerts + swiper init b√°sico) -->
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      if (document.querySelector('.swiper-container')) {
        new Swiper('.swiper-container', {
          slidesPerView: 'auto',
          spaceBetween: 16,
          navigation: { nextEl: '.swiper-button-next', prevEl: '.swiper-button-prev' },
          pagination: { el: '.swiper-pagination', clickable: true },
        });
      }
      document.querySelectorAll('.alert-message').forEach(alert => {
        setTimeout(() => {
          alert.classList.add('opacity-0', 'transition-opacity', 'duration-500');
          setTimeout(() => alert.remove(), 500);
        }, 2000);
      });
    });
  </script>

  {% block scripts %}{% endblock %}
</body>
</html>
